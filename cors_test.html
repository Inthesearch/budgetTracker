<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORS Test</title>
</head>
<body>
    <h1>CORS Test for Budget Tracker API</h1>
    <div id="results"></div>

    <script>
        const API_BASE_URL = 'https://budgettracker-yiw5.onrender.com';
        const resultsDiv = document.getElementById('results');

        function log(message) {
            const div = document.createElement('div');
            div.innerHTML = message;
            resultsDiv.appendChild(div);
            console.log(message);
        }

        async function testEndpoint(endpoint, method = 'GET', body = null) {
            const url = `${API_BASE_URL}${endpoint}`;
            log(`<h3>Testing: ${method} ${url}</h3>`);
            
            try {
                const options = {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    mode: 'cors'
                };

                if (body) {
                    options.body = JSON.stringify(body);
                }

                const response = await fetch(url, options);
                
                log(`Status: ${response.status}`);
                log(`Headers: ${JSON.stringify(Object.fromEntries(response.headers.entries()), null, 2)}`);
                
                if (response.ok) {
                    const data = await response.text();
                    log(`Response: ${data.substring(0, 200)}...`);
                    log(`✅ Success!`);
                } else {
                    log(`❌ Failed`);
                }
            } catch (error) {
                log(`❌ Error: ${error.message}`);
            }
            
            log('<hr>');
        }

        async function runTests() {
            log('<h2>Starting CORS Tests...</h2>');
            
            // Test basic endpoints
            await testEndpoint('/');
            await testEndpoint('/health');
            await testEndpoint('/cors-test');
            
            // Test API endpoints
            await testEndpoint('/api/v1/category/list');
            
            // Test with authentication header
            await testEndpoint('/api/v1/category/list', 'GET', null, {
                'Authorization': 'Bearer test-token'
            });
            
            log('<h2>CORS Tests Complete!</h2>');
        }

        // Run tests when page loads
        window.onload = runTests;
    </script>
</body>
</html> 